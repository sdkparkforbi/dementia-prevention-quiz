<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ì¹˜ë§¤ì˜ˆë°© ë‘ë‡Œ ê²Œì„</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: 'Malgun Gothic', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }
        .container {
            max-width: 900px;
            margin: 0 auto;
        }
        h1 {
            text-align: center;
            color: white;
            font-size: 2.5em;
            margin-bottom: 30px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }
        .user-section {
            background: white;
            padding: 20px;
            border-radius: 15px;
            margin-bottom: 20px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
        }
        .user-section input {
            width: 100%;
            padding: 15px;
            font-size: 1.2em;
            border: 2px solid #667eea;
            border-radius: 10px;
        }
        .quiz-card {
            background: white;
            padding: 30px;
            border-radius: 20px;
            margin-bottom: 20px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
        }
        .quiz-number {
            background: #667eea;
            color: white;
            padding: 8px 20px;
            border-radius: 20px;
            display: inline-block;
            margin-bottom: 15px;
            font-weight: bold;
        }
        .quiz-question {
            font-size: 1.3em;
            color: #333;
            margin-bottom: 20px;
            line-height: 1.6;
        }
        .options {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }
        .option {
            padding: 15px 20px;
            background: #f8f9fa;
            border: 2px solid #e9ecef;
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.3s;
            font-size: 1.1em;
        }
        .option:hover {
            background: #e7f1ff;
            border-color: #667eea;
        }
        .option.selected {
            background: #667eea;
            color: white;
            border-color: #667eea;
        }
        .option.correct {
            background: #28a745;
            color: white;
            border-color: #28a745;
        }
        .option.wrong {
            background: #dc3545;
            color: white;
            border-color: #dc3545;
        }
        .submit-btn {
            width: 100%;
            padding: 18px;
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            border: none;
            border-radius: 12px;
            font-size: 1.3em;
            cursor: pointer;
            margin-top: 20px;
            transition: transform 0.2s;
        }
        .submit-btn:hover { transform: scale(1.02); }
        .submit-btn:disabled {
            background: #ccc;
            cursor: not-allowed;
            transform: none;
        }
        .result-box {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 12px;
            margin-top: 15px;
            display: none;
        }
        .result-box.show { display: block; }
        .result-box.correct-result {
            background: #d4edda;
            border: 2px solid #28a745;
        }
        .result-box.wrong-result {
            background: #f8d7da;
            border: 2px solid #dc3545;
        }
        .score-display {
            text-align: center;
            background: white;
            padding: 30px;
            border-radius: 20px;
            margin-top: 20px;
            display: none;
        }
        .score-display.show { display: block; }
        .score-number {
            font-size: 4em;
            color: #667eea;
            font-weight: bold;
        }
        .status-message {
            text-align: center;
            padding: 15px;
            border-radius: 10px;
            margin-top: 15px;
            display: none;
        }
        .status-message.show { display: block; }
        .status-message.success { background: #d4edda; color: #155724; }
        .status-message.error { background: #f8d7da; color: #721c24; }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ§  ì¹˜ë§¤ì˜ˆë°© ë‘ë‡Œ ê²Œì„</h1>
        
        <div class="user-section">
            <label style="font-size: 1.2em; margin-bottom: 10px; display: block; color: #333;">
                ğŸ‘¤ ì´ë¦„ì„ ì…ë ¥í•´ì£¼ì„¸ìš”
            </label>
            <input type="text" id="userName" placeholder="í™ê¸¸ë™">
        </div>

        <div id="quizContainer"></div>

        <button class="submit-btn" id="submitBtn" onclick="submitAllAnswers()">
            ğŸ“ ë‹µë³€ ì œì¶œí•˜ê¸°
        </button>

        <div class="status-message" id="statusMessage"></div>

        <div class="score-display" id="scoreDisplay">
            <p style="font-size: 1.5em; margin-bottom: 10px;">ìµœì¢… ì ìˆ˜</p>
            <div class="score-number" id="finalScore">0</div>
            <p style="font-size: 1.2em; color: #666;">/ <span id="totalQuestions">0</span>ë¬¸ì œ</p>
        </div>
    </div>

    <!-- D-ID ì•„ë°”íƒ€ -->
    <script type="module"
        src="https://agent.d-id.com/v2/index.js"
        data-mode="fabio"
        data-client-key="Z29vZ2xlLW9hdXRoMnwxMTI3NjQ3MzA0NTM3NjA0MTgyMTI6d01EN0x6bFFFMmlZSk9nUHNacXll"
        data-agent-id="v2_agt_adow2aMU"
        data-name="did-agent"
        data-monitor="true"
        data-orientation="horizontal"
        data-position="right">
    </script>

    <script>
        const quizData = [
            {
                question: "ë‹¤ìŒ ì¤‘ ì¹˜ë§¤ ì˜ˆë°©ì— ê°€ì¥ íš¨ê³¼ì ì¸ í™œë™ì€ ë¬´ì—‡ì¼ê¹Œìš”?",
                options: [
                    "í•˜ë£¨ ì¢…ì¼ TV ì‹œì²­í•˜ê¸°",
                    "ê·œì¹™ì ì¸ ìš´ë™ê³¼ ë‘ë‡Œ í™œë™",
                    "í˜¼ìì„œ ì§‘ì—ë§Œ ìˆê¸°",
                    "ê°™ì€ ìŒì‹ë§Œ ë¨¹ê¸°"
                ],
                correct: 1,
                explanation: "ê·œì¹™ì ì¸ ìš´ë™ì€ ë‡Œ í˜ˆë¥˜ë¥¼ ì¦ê°€ì‹œí‚¤ê³ , ë‘ë‡Œ í™œë™ì€ ì‹ ê²½ ì—°ê²°ì„ ê°•í™”í•˜ì—¬ ì¹˜ë§¤ ì˜ˆë°©ì— íš¨ê³¼ì ì…ë‹ˆë‹¤."
            },
            {
                question: "ê¸°ì–µë ¥ í–¥ìƒì— ë„ì›€ì´ ë˜ëŠ” ì‹í’ˆì´ ì•„ë‹Œ ê²ƒì€?",
                options: [
                    "ë“±í‘¸ë¥¸ ìƒì„  (ê³ ë“±ì–´, ì—°ì–´)",
                    "í˜¸ë‘, ì•„ëª¬ë“œ ë“± ê²¬ê³¼ë¥˜",
                    "ì‹œê¸ˆì¹˜, ë¸Œë¡œì½œë¦¬ ë“± ë…¹ìƒ‰ ì±„ì†Œ",
                    "ê°€ê³µì‹í’ˆê³¼ íŒ¨ìŠ¤íŠ¸í‘¸ë“œ"
                ],
                correct: 3,
                explanation: "ì˜¤ë©”ê°€-3ê°€ í’ë¶€í•œ ìƒì„ , ë¹„íƒ€ë¯¼Eê°€ ë§ì€ ê²¬ê³¼ë¥˜, í•­ì‚°í™” ì„±ë¶„ì´ í’ë¶€í•œ ë…¹ìƒ‰ ì±„ì†ŒëŠ” ë‡Œ ê±´ê°•ì— ì¢‹ìŠµë‹ˆë‹¤. ê°€ê³µì‹í’ˆì€ ë‡Œ ê±´ê°•ì— í•´ë¡­ìŠµë‹ˆë‹¤."
            },
            {
                question: "ì¹˜ë§¤ ì´ˆê¸° ì¦ìƒìœ¼ë¡œ ì˜¬ë°”ë¥¸ ê²ƒì€?",
                options: [
                    "ìµœê·¼ ì¼ì„ ìì£¼ ìŠì–´ë²„ë¦°ë‹¤",
                    "ì˜›ë‚  ì¼ì„ ê¸°ì–µí•˜ì§€ ëª»í•œë‹¤",
                    "ëª¨ë“  ê²ƒì„ ì™„ë²½í•˜ê²Œ ê¸°ì–µí•œë‹¤",
                    "ì ì„ ë§ì´ ì”ë‹¤"
                ],
                correct: 0,
                explanation: "ì¹˜ë§¤ ì´ˆê¸°ì—ëŠ” ìµœê·¼ ì¼(ë‹¨ê¸° ê¸°ì–µ)ì„ ìŠì–´ë²„ë¦¬ëŠ” ì¦ìƒì´ ë¨¼ì € ë‚˜íƒ€ë‚˜ê³ , ì˜¤ë˜ëœ ê¸°ì–µ(ì¥ê¸° ê¸°ì–µ)ì€ ë¹„êµì  ë³´ì¡´ë©ë‹ˆë‹¤."
            },
            {
                question: "ë‘ë‡Œ ê±´ê°•ì„ ìœ„í•œ ìˆ˜ë©´ ì‹œê°„ìœ¼ë¡œ ì ë‹¹í•œ ê²ƒì€?",
                options: [
                    "3-4ì‹œê°„",
                    "5-6ì‹œê°„",
                    "7-8ì‹œê°„",
                    "10ì‹œê°„ ì´ìƒ"
                ],
                correct: 2,
                explanation: "ì„±ì¸ì€ 7-8ì‹œê°„ì˜ ìˆ˜ë©´ì´ ê¶Œì¥ë©ë‹ˆë‹¤. ìˆ˜ë©´ ì¤‘ì— ë‡Œì˜ ë…¸íë¬¼ì´ ì œê±°ë˜ê³  ê¸°ì–µì´ ì •ë¦¬ë©ë‹ˆë‹¤."
            },
            {
                question: "ë‹¤ìŒ ì¤‘ ì‚¬íšŒì  í™œë™ì´ ì¹˜ë§¤ ì˜ˆë°©ì— ë„ì›€ì´ ë˜ëŠ” ì´ìœ ëŠ”?",
                options: [
                    "ëˆì„ ë²Œ ìˆ˜ ìˆì–´ì„œ",
                    "ë‡Œë¥¼ ë‹¤ì–‘í•˜ê²Œ ìê·¹í•˜ê¸° ë•Œë¬¸ì—",
                    "ìš´ë™ëŸ‰ì´ ëŠ˜ì–´ì„œ",
                    "ì‹ì‚¬ë¥¼ ì˜ í•˜ê²Œ ë˜ì–´ì„œ"
                ],
                correct: 1,
                explanation: "ì‚¬íšŒì  í™œë™ì€ ëŒ€í™”, ê°ì • êµë¥˜, ë¬¸ì œ í•´ê²° ë“± ë‹¤ì–‘í•œ ë‡Œ ê¸°ëŠ¥ì„ ì‚¬ìš©í•˜ê²Œ í•˜ì—¬ ì¸ì§€ ê¸°ëŠ¥ ìœ ì§€ì— ë„ì›€ì´ ë©ë‹ˆë‹¤."
            }
        ];

        let userAnswers = {};

        function renderQuizzes() {
            const container = document.getElementById('quizContainer');
            container.innerHTML = quizData.map((quiz, index) => `
                <div class="quiz-card" id="quiz-${index}">
                    <div class="quiz-number">ë¬¸ì œ ${index + 1}</div>
                    <div class="quiz-question">${quiz.question}</div>
                    <div class="options">
                        ${quiz.options.map((opt, optIndex) => `
                            <div class="option" data-quiz="${index}" data-option="${optIndex}" onclick="selectOption(${index}, ${optIndex})">
                                ${optIndex + 1}. ${opt}
                            </div>
                        `).join('')}
                    </div>
                    <div class="result-box" id="result-${index}">
                        <strong>í•´ì„¤:</strong> ${quiz.explanation}
                    </div>
                </div>
            `).join('');
            document.getElementById('totalQuestions').textContent = quizData.length;
        }

        function selectOption(quizIndex, optionIndex) {
            const options = document.querySelectorAll(`[data-quiz="${quizIndex}"]`);
            options.forEach(opt => opt.classList.remove('selected'));
            options[optionIndex].classList.add('selected');
            userAnswers[quizIndex] = optionIndex;
        }

        async function submitAllAnswers() {
            const userName = document.getElementById('userName').value.trim();
            if (!userName) {
                alert('ì´ë¦„ì„ ì…ë ¥í•´ì£¼ì„¸ìš”!');
                return;
            }

            if (Object.keys(userAnswers).length < quizData.length) {
                alert('ëª¨ë“  ë¬¸ì œì— ë‹µí•´ì£¼ì„¸ìš”!');
                return;
            }

            const submitBtn = document.getElementById('submitBtn');
            submitBtn.disabled = true;
            submitBtn.textContent = 'â³ ì €ì¥ ì¤‘...';

            let correctCount = 0;
            const results = [];

            quizData.forEach((quiz, index) => {
                const userAnswer = userAnswers[index];
                const isCorrect = userAnswer === quiz.correct;
                if (isCorrect) correctCount++;

                const options = document.querySelectorAll(`[data-quiz="${index}"]`);
                options[userAnswer].classList.add(isCorrect ? 'correct' : 'wrong');
                if (!isCorrect) {
                    options[quiz.correct].classList.add('correct');
                }

                const resultBox = document.getElementById(`result-${index}`);
                resultBox.classList.add('show', isCorrect ? 'correct-result' : 'wrong-result');

                results.push({
                    question: quiz.question,
                    userAnswer: quiz.options[userAnswer],
                    correctAnswer: quiz.options[quiz.correct],
                    isCorrect: isCorrect
                });
            });

            document.getElementById('finalScore').textContent = correctCount;
            document.getElementById('scoreDisplay').classList.add('show');

            const answerData = {
                userName: userName,
                score: correctCount,
                total: quizData.length,
                results: results,
                timestamp: new Date().toISOString()
            };

            const response = await fetch('/.netlify/functions/save-answer', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify(answerData)
            });

            const statusMessage = document.getElementById('statusMessage');
            if (response.ok) {
                const data = await response.json();
                statusMessage.textContent = `âœ… ${userName}ë‹˜ì˜ ê²°ê³¼ê°€ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤! ì•„ë°”íƒ€ì—ê²Œ ê²°ê³¼ë¥¼ ë¬¼ì–´ë³´ì„¸ìš”.`;
                statusMessage.className = 'status-message show success';
            } else {
                statusMessage.textContent = 'âš ï¸ ì €ì¥ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.';
                statusMessage.className = 'status-message show error';
            }

            submitBtn.textContent = 'âœ… ì œì¶œ ì™„ë£Œ';
        }

        renderQuizzes();
    </script>
</body>
</html>
